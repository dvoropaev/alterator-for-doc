- [1. Интерфейсы org.altlinux.alterator.diagX](#1-интерфейсы-org-altlinux-alterator-diagx)
	- [1.1. Спецификация интерфейса org.altlinux.alterator.diag1](#1-1-спецификация-интерфейса-org-altlinux-alterator-diag1)
		- [1.1.1. Методы](#1-1-1-методы)
			- [1.1.1.1. Info](#1-1-1-1-info)
			- [1.1.1.2. List](#1-1-1-2-list)
			- [1.1.1.3. Report](#1-1-1-3-report)
			- [1.1.1.4. Run](#1-1-1-4-run)
		- [1.1.2. Сигналы](#1-1-2-сигналы)
			- [1.1.2.1. diag1\_stderr\_signal](#1-1-2-1-diag1_stderr_signal)
			- [1.1.2.2. diag1\_stdout\_signal](#1-1-2-2-diag1_stdout_signal)

# 1. Интерфейсы org.altlinux.alterator.diagX

Интерфейсы `diag` предназначены для взаимодействия с инструментами диагностики.

## 1.1. Спецификация интерфейса org.altlinux.alterator.diag1

Данный интерфейс должен быть реализован для каждого инструмента диагностики. 

Все реализации интерфейса должны обладать **исключительно** методами и сигналами описанными в данной спецификации. Сигнатуры методов и сигналов также должы полностью совпадать с описанноми в спецификации. В обратном случае валидация данной реализации провалится и экземпляр интерфейса **не будет** зарегистрирован на D-Bus.

### 1.1.1. Методы 

#### 1.1.1.1. Info

Метод `Info () -> (Array of [Byte] stdout_bytes, Int32 response)` предназначен для предоставления информации об инструменте диагностики, представленном данным объектом, в формате [Alterator Entry](https://altlinux.space/alterator/alterator-entry/src/branch/master/doc#сущность-типа-diag-или-diagnostictool) (сущность типа `Diag`). Результатом выполнения метода является пара массива байтов `stdout_bytes`, который содержит Alterator Entry, и целочисленного числа `response`, отражающего код возврата метода. 

#### 1.1.1.2. List

Метод `List () -> (Array of [String] stdout_strings, Int32 response)` должен применяться для перечисления всех тестов инструмента. Список строк `stdout_strings` содежит названия инструментов (каждая строка из списка соответствует названию одного из тестов), а целое число `response` &mdash; код возврата метода.

#### 1.1.1.3. Report

Метод `Report () -> (Array of [Byte] stdout_bytes, Int32 response)` возвращает лог пройденных тестов<!--TODO(kozyrevid): format of the log is unclear. Find out and complete-->. Выходной аргумент `stdout_bytes` должен содержать лог инструмента в виде байтового массива. А параметр  `response` &mdash; целое число, код возврата метода.

#### 1.1.1.4. Run

Метод `Run (String param) -> (Int32 response)` должен выполнять тест `param` данного инструмента. Входной строковый аргумент `param` позволяет указать название теста, а выходной параметр `response` &mdash; целое число, код возврата метода.   
Предусмотрены следующие коды возврата:

| **Число** | **Значение**   |
|:----------|:---------------|
| `0`     	| успех 	     |
| `2`       | предупреждение |
| ...    	| ошибка         |



### 1.1.2. Сигналы

#### 1.1.2.1. diag1_stderr_signal

Сигнал `diag1_stderr_signal(String)` позволяет асинхронно передавать содержимое стандартного потока ошибок из экземпляра терминала, в котором выполняется тест, одно сообщение данного сигнала соответствует сторке из потока `stderr`.

#### 1.1.2.2. diag1_stdout_signal

Сигнал `diag1_stdout_signal(String)` позволяет асинхронно передавать содержимое стандартного вывода ошибок из экземпляра терминала, в котором выполняется тест, одно сообщение данного сигнала соответствует сторке из потока `stdout`.
